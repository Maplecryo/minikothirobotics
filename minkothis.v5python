{"mode":"Text","hardwareTarget":"brain","textContent":"#region VEXcode Robot Configuration\nfrom vex import *\nimport urandom\nimport math\nimport time\n\n# Brain\nbrain = Brain()\n\n# Robot configuration\nleft_motor_a = Motor(Ports.PORT1, GearSetting.RATIO_18_1, False)\nleft_motor_b = Motor(Ports.PORT2, GearSetting.RATIO_18_1, False)\nleft_drive_smart = MotorGroup(left_motor_a, left_motor_b)\nright_motor_a = Motor(Ports.PORT4, GearSetting.RATIO_18_1, True)\nright_motor_b = Motor(Ports.PORT3, GearSetting.RATIO_18_1, True)\nright_drive_smart = MotorGroup(right_motor_a, right_motor_b)\ndrivetrain = DriveTrain(left_drive_smart, right_drive_smart, 319.19, 12.446, 139.7, MM, 1)\n\nmid_inmotor = Motor(Ports.PORT5, GearSetting.RATIO_18_1, False)\ndecider = Motor(Ports.PORT6, GearSetting.RATIO_18_1, False)\ndecider.set_velocity(100, PERCENT)\ntop_inmotor = Motor(Ports.PORT7, GearSetting.RATIO_18_1, False)\noffload = Motor(Ports.PORT8, GearSetting.RATIO_18_1, False)\nintake = Motor(Ports.PORT10, GearSetting.RATIO_18_1, False)\narm = Motor(Ports.PORT9, GearSetting.RATIO_18_1, False)\n\ncontroller_1 = Controller(PRIMARY)\n\nwait(30, MSEC)\n\n# State variables\ncontroller_1_left_shoulder_control_motors_stopped = True\ncontroller_1_right_shoulder_control_motors_stopped = True\ncontroller_1_up_down_buttons_control_motors_stopped = True\ncontroller_1_x_b_buttons_control_motors_stopped = True\ndrivetrain_needs_to_be_stopped_controller_1 = False\n\n# Arm control variables\narm_position = 0\nincrement = 15\nprev_a_state = False\nprev_y_state = False\nprev_left_state = False\nprev_right_state = False\n\n# Intake flags\ndowntake_running = False\nmidtake_running = False\n\n# Intake sequences\ndef intakesequence():\n    intake.spin_for(FORWARD, 360, DEGREES, wait=False)\n    mid_inmotor.spin_for(REVERSE, 360, DEGREES, wait=False)\n    decider.spin_for(REVERSE, 360, DEGREES, wait=False)\n\ndef downtake():\n    global downtake_running\n    if downtake_running:\n        return\n    downtake_running = True\n    try:\n        decider.spin_for(REVERSE, 720, DEGREES, wait=False)\n        intake.spin_for(FORWARD, 360, DEGREES, wait=False)\n        mid_inmotor.spin_for(REVERSE, 360, DEGREES, wait=False)\n    finally:\n        downtake_running = False\n\ndef midtake():\n    global midtake_running\n    if midtake_running:\n        return\n    midtake_running = True\n    try:\n        decider.spin_for(REVERSE, 360, DEGREES, wait=False)\n        intake.spin_for(FORWARD, 270, DEGREES, wait=False)\n        decider.spin_for(FORWARD, 180, DEGREES, wait=False)\n        intake.spin_for(REVERSE, 270, DEGREES, wait=False)\n    finally:\n        midtake_running = False\n\n# Controller loop\ndef rc_auto_loop_function_controller_1():\n    global drivetrain_needs_to_be_stopped_controller_1\n    global controller_1_left_shoulder_control_motors_stopped\n    global controller_1_right_shoulder_control_motors_stopped\n    global controller_1_up_down_buttons_control_motors_stopped\n    global controller_1_x_b_buttons_control_motors_stopped\n    global arm_position, prev_a_state, prev_y_state, prev_left_state, prev_right_state\n    global remote_control_code_enabled\n\n    while True:\n        if remote_control_code_enabled:\n            # Joystick drive\n            drivetrain_left_side_speed = controller_1.axis2.position() + controller_1.axis1.position()\n            drivetrain_right_side_speed = controller_1.axis2.position() - controller_1.axis1.position()\n\n            if abs(drivetrain_left_side_speed) < 5 and abs(drivetrain_right_side_speed) < 5:\n                if drivetrain_needs_to_be_stopped_controller_1:\n                    left_drive_smart.stop()\n                    right_drive_smart.stop()\n                    drivetrain_needs_to_be_stopped_controller_1 = False\n            else:\n                drivetrain_needs_to_be_stopped_controller_1 = True\n\n            if drivetrain_needs_to_be_stopped_controller_1:\n                left_drive_smart.set_velocity(drivetrain_left_side_speed, PERCENT)\n                left_drive_smart.spin(FORWARD)\n                right_drive_smart.set_velocity(drivetrain_right_side_speed, PERCENT)\n                right_drive_smart.spin(FORWARD)\n\n            # L1/L2 control mid motor\n            if controller_1.buttonL1.pressing():\n                mid_inmotor.spin(FORWARD)\n                controller_1_left_shoulder_control_motors_stopped = False\n            elif controller_1.buttonL2.pressing():\n                mid_inmotor.spin(REVERSE)\n                controller_1_left_shoulder_control_motors_stopped = False\n            elif not controller_1_left_shoulder_control_motors_stopped:\n                mid_inmotor.stop()\n                controller_1_left_shoulder_control_motors_stopped = True\n\n            # R1/R2 control intake\n            if controller_1.buttonR1.pressing():\n                intake.spin(FORWARD)\n                controller_1_right_shoulder_control_motors_stopped = False\n            elif controller_1.buttonR2.pressing():\n                intake.spin(REVERSE)\n                controller_1_right_shoulder_control_motors_stopped = False\n            elif not controller_1_right_shoulder_control_motors_stopped:\n                intake.stop()\n                controller_1_right_shoulder_control_motors_stopped = True\n\n            # Up/Down control decider\n            if controller_1.buttonUp.pressing():\n                decider.spin(FORWARD)\n                controller_1_up_down_buttons_control_motors_stopped = False\n            elif controller_1.buttonDown.pressing():\n                decider.spin(REVERSE)\n                controller_1_up_down_buttons_control_motors_stopped = False\n            elif not controller_1_up_down_buttons_control_motors_stopped:\n                decider.stop()\n                controller_1_up_down_buttons_control_motors_stopped = True\n\n            # X/B control\n            x_pressed = controller_1.buttonX.pressing()\n            b_pressed = controller_1.buttonB.pressing()\n\n            if x_pressed:\n                Thread(intakesequence)\n                while controller_1.buttonX.pressing():\n                    wait(500, MSEC)\n                    Thread(intakesequence)\n            elif b_pressed:\n                top_inmotor.spin(REVERSE)\n                controller_1_x_b_buttons_control_motors_stopped = False\n            elif not controller_1_x_b_buttons_control_motors_stopped:\n                top_inmotor.stop()\n                controller_1_x_b_buttons_control_motors_stopped = True\n\n\n            # Arm control\n            a_pressed = controller_1.buttonA.pressing()\n            y_pressed = controller_1.buttonY.pressing()\n\n            if a_pressed and not prev_a_state:\n                arm_position += increment\n                arm.spin_to_position(arm_position, DEGREES, 100, PERCENT)\n\n            if y_pressed and not prev_y_state:\n                arm_position -= increment\n                arm.spin_to_position(arm_position, DEGREES, 100, PERCENT)\n\n            prev_a_state = a_pressed\n            prev_y_state = y_pressed\n\n            # Left arrow triggers midtake\n            left_pressed = controller_1.buttonLeft.pressing()\n            if left_pressed and not prev_left_state:\n                Thread(midtake)  # starts midtake without blocking the loop\n            prev_left_state = left_pressed\n\n            # Right arrow triggers downtake\n            right_pressed = controller_1.buttonRight.pressing()\n            if right_pressed and not prev_right_state:\n                Thread(downtake)  # starts downtake without blocking the loop\n            prev_right_state = right_pressed\n\n\n        wait(20, MSEC)\n\n# Enable controller\n# Enable controller\nremote_control_code_enabled = True\n\n# Start the controller loop thread\nrc_auto_loop_thread_controller_1 = Thread(rc_auto_loop_function_controller_1)\n\n#endregion\n","textLanguage":"python","robotConfig":[{"port":[1,2,4,3,0],"name":"drivetrain","customName":false,"deviceType":"Drivetrain","deviceClass":"smartdrive","setting":{"type":"4-motor","wheelSize":"wheel4in","gear":"ratio18_1","gearRatio":"1:1","direction":"fwd","gyroType":"none","width":"0.49","unit":"in","wheelbase":"5.5","wheelbaseUnit":"in","xOffset":"0","xOffsetUnit":"mm","yOffset":"0","yOffsetUnit":"mm","thetaOffset":"180"},"triportSourcePort":null},{"port":[5],"name":"mid_inmotor","customName":true,"deviceType":"Motor","deviceClass":"motor","setting":{"reversed":"false","fwd":"forward","rev":"reverse","gear":"ratio18_1"},"triportSourcePort":22},{"port":[6],"name":"decider","customName":true,"deviceType":"Motor","deviceClass":"motor","setting":{"reversed":"false","fwd":"forward","rev":"reverse","gear":"ratio18_1"},"triportSourcePort":22},{"port":[7],"name":"top_inmotor","customName":true,"deviceType":"Motor","deviceClass":"motor","setting":{"reversed":"false","fwd":"forward","rev":"reverse","gear":"ratio18_1"},"triportSourcePort":22},{"port":[8],"name":"offload","customName":true,"deviceType":"Motor","deviceClass":"motor","setting":{"reversed":"false","fwd":"forward","rev":"reverse","gear":"ratio18_1"},"triportSourcePort":22},{"port":[],"name":"controller_1","customName":false,"deviceType":"Controller","deviceClass":"controller","setting":{"left":"mid_inmotor","leftDir":"false","right":"intake","rightDir":"false","upDown":"decider","upDownDir":"false","xB":"top_inmotor","xBDir":"false","drive":"arcader","id":"primary"},"triportSourcePort":22},{"port":[10],"name":"intake","customName":true,"deviceType":"Motor","deviceClass":"motor","setting":{"reversed":"false","fwd":"forward","rev":"reverse","gear":"ratio18_1","id":"partner"},"triportSourcePort":22},{"port":[9],"name":"arm","customName":true,"deviceType":"Motor","deviceClass":"motor","setting":{"reversed":"false","fwd":"forward","rev":"reverse","gear":"ratio18_1","id":"partner"},"triportSourcePort":22}],"slot":0,"platform":"V5","sdkVersion":"20240802.15.00.00","appVersion":"4.61.0","fileFormat":"2.0.0","targetBrainGen":"First","v5Sounds":[{"name":"game over","url":"static/sounds/mixkit-arcade-retro-game-over-213.wav"}],"v5SoundsEnabled":false,"aiVisionSettings":{"colors":[],"codes":[],"tags":true,"AIObjects":true,"AIObjectModel":[],"aiModelDropDownValue":null}}